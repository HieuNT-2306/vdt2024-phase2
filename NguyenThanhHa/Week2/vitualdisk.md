# VDI vs VHD vs VMDK

## Virtual Hard Disk (VHD)

A virtual hard disk (VHD) is a disk image file format for storing the entire contents of a hard drive. It is a container that can store a virtual hard disk drive. The disk images, sometimes called virtual machine, replicates an existing hard drive and includes all data and structural elements. It can be stored in any location accessible to the physical host and it is also transportable, allowing it to be moved from one host to another.

VHDs are commonly used by virtualization software to store files and data. They are used to create virtual machines, which are software-based computers that run on a physical host computer. Virtual machines can be used to run multiple operating systems on a single physical computer, allowing users to run different applications and services on the same hardware.

## Virtual Hard Disk vs Physical Hard Disk
A virtual hard disk has similar functionality to a physical hard disk drive. For example, it often contains the same hard drive sectors, such as a file system, disk partitions, etc. It also appears and operates like a hard disk that's physically connected to the system. Like a hard disk, the VHD can do the following:
- create disk sectors, files, and folders
- run an operating system
- execute user applications

What differentiates the VHD from a physical hard disk is that it is designed for use by virtual machines and is installed on a virtual machine infrastructure, most commonly VMware Workstation and Hyper-V VMs.

While a VHD is created on a physical hard drive, it is a "virtualized" file and has its own logical distribution. Its disk size can be fixed or flexible. This size is managed by the operating system (OS) or virtualization manager. The OS communicates with the device drivers to access the VHD.

## Types of Virtual Hard Disks

### Fixed-size VHD
A fixed-size VHD is a disk image file that is created with a specific size. The entire disk space is allocated when the VHD is created, and the file size remains constant regardless of the amount of data stored on the virtual disk. Fixed-size VHDs are faster to create and provide better performance compared to dynamically expanding VHDs. However, they consume more physical disk space, as the allocated space is not used until data is written to the virtual disk.

### Dynamically expanding VHD

A dynamically expanding VHD is a disk image file that grows in size as data is written to the virtual disk. The initial size of the VHD file is small, and it expands dynamically as more data is stored on the virtual disk. Dynamically expanding VHDs are more space-efficient compared to fixed-size VHDs, as they only consume physical disk space for the data stored on the virtual disk. However, they may have slightly lower performance compared to fixed-size VHDs, as the VHD file needs to grow in size as data is written to the virtual disk.

### Differencing VHD

A differencing VHD is a disk image file that is used as a parent disk for other VHDs. It contains the base operating system or data that is shared among multiple virtual machines. Two VHDs are used, a parent and a child. When a differencing VHD is created, it references the parent VHD and stores only the changes made to the virtual disk. This allows multiple virtual machines to share the same base disk image while maintaining separate data and configurations. Differencing VHDs are commonly used in virtual machine environments to reduce storage space and simplify management of virtual disks.

![](./image11.png)

## Benefits of Virtual Hard Disks

### Easy deployment
A VHD has provisions for pre-built and standard configurations in the VHD files for working on specific operating system environments, which simplifies deployment.
### Efficient backup and recovery
VHDs can be easily backed up and restored, allowing for quick recovery in case of system failures or data loss.
### Snapshot recovery
A snapshot of an existing VHD configuration can be recovered, allowing a user to revert to a previous stage if there are installation problems and troubleshooting doesn't offer any fixes.

### Swift replication
The work or file in one system can be replicated in another system by copying the VHD file, which is a simple and quick process.

### Isolation for users
Users can work on their chosen OS without affecting the host system, as the VHD is isolated from the host system.

### Cost-effective
VHDs are cost-effective as they reduce the need for physical hardware and allow multiple virtual machines to run on a single physical host.

## VHD vs VHDX

Virtual hard disk (VHD) is a disk format standard for Microsoft’s virtualization products, including the now-discontinued Microsoft Virtual PC and Virtual Server. VHD remains supported in the virtualization space despite the discontinuation of these products; however, it has been replaced by the Virtual Hard Disk v2 (VHDX) format, the default for the Microsoft Hyper-V hypervisor introduced in Windows 2012. The VHDX format boasts a substantial storage capacity of 64 TB compared to the lower 2 TB limit of VHD.

VHDX is functionally equivalent to VHD. However, it is an advanced version of VHD that  supports larger storage capacity, larger logical sectors and live disk resizing. VHDX also provides the following advantages over VHD:
- metadata updates tracking
- data protection against power failures
- more adaptable to new storage hardware
- improved alignment of the virtual hard disk format to work well on large sector disks
- support for custom metadata

The VHD and VHDX file format specifications are available to third parties, ensuring broad support across various virtualization platforms. Microsoft has also released application programming interfaces (APIs) to easily create Windows images in VHD files. Microsoft PowerShell scripts are also available for converting an existing virtual hard disk from dynamic to fixed and vice versa, from VHD to VHDX, or a pass-through disk to a virtual hard disk.

# Vitual Disk Image (VDI)

Virtual disk image (VDI) is the default disk format for Oracle VM VirtualBox, a popular open-source virtualization product. Virtual disks created in VirtualBox bear the .vdi extension. VDI is generally compatible with various virtualization programs.

VDI offers flexibility in storage allocation, supporting both fixed-size and dynamically allocated storage. This dynamic allocation feature allows for the expansion of an image file after its creation, even if it already houses data.

VDI files are more compact and outperform VHD or VHDX files on a few key criteria. However, they fall short in speed when compared to VMDK files. While VDI lacks support for incremental backups–a feature present in VMDK–it compensates with high-level redundancy, mitigating the impact of data loss on virtual machines.

It’s important to note that converting other formats to VDI isn’t always feasible. Also, devices must have VirtualBox installed before being equipped with a .vdi virtual disk. Users should strive to understand their virtualization software’s specific requirements and capabilities to ensure no compatibility or functionality issues arise during use.

# Virtual Machine Disk (VMDK)
Virtual machine disk (VMDK) was initially a proprietary format for VMware virtual appliances. Today, it has evolved into an open format and gained widespread acceptance across virtualization platforms, including Hyper-V and VirtualBox.

VMDK facilitates the cloning of physical hard disks and off-site VM backups. Once VMware vSphere 5.5 was introduced in 2013, VMDK’s storage capacity saw a 31-fold leap: from 2 TB to 62 TB. VMDK files can be dynamic (sparse) or fixed (flat). Dynamic disks, starting small, grow in tandem with the guest OS file size. Conversely, fixed disks remain static, and a large size is pre-allocated to them to accommodate anticipated VM usage growth.

A key feature of VMDK is its support for incremental backups, allowing data changes since the last backup to be stored. This feature, missing from VDI and VHD, accelerates the VMDK backup process.

VMDK also comes with several other advantages, including:
- Live migration enables VMs to be moved or migrated to another server
- Snapshots and continuous data protection (CDP) provides a safety net against data loss
- High-performance Storage Area Network (SAN) storage utilization enhances storage efficiency
- VM recreation and restart with backup VMDK files ensures business continuity

# Key Differences Between VDI, VHD, and VMDK
A VDI is the image of a virtual hard disk or the logical disk associated with a virtual machine. A VHD is a disk image file format used for the virtualized storage of the contents of a computer’s hard drive. Finally, a VMDK is a format specification for virtual machine disk image files.

| Feature          | VDI                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | VHD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | VMDK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **File Extension** | .vdi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | .vhd                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | .vmdk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Operations**   | The VDI format was developed for Oracle’s open-source virtualization solution, VM VirtualBox. This format introduced a revolutionary method for interacting with operating systems. Simply put, it enables users to run programs written for various operating systems in a high-speed virtual environment on platforms such as Mac, Windows, and UNIX. <br><br> One of VDI’s key features is its compatibility with and portability to other virtualization software. Additionally, it supports dynamically allocated storage, optimizing space utilization. <br><br> Unofficial tests suggest that VDI outperforms VHD in terms of speed and efficiency. Not only does it seem to operate faster but it also maintains smaller file sizes on average, making it a more efficient choice for certain applications. <br><br> A core feature of VDI is remote access, enabling users to access their virtual environment from anywhere. However, the availability of this feature also depends on VirtualBox configuration and is not a built-in feature of VDI. <br><br> Additionally, the presence of a hypervisor ensures uninterrupted operation. In case of a physical server failure, the desktop instance seamlessly transitions to another server, ensuring continuous operation. It is important to note that while a hypervisor is commonly used in VirtualBox configurations, it is not a core feature of the VDI format itself. | The VHD format was initially developed by Connectix for its Virtual PC product and was later acquired by Microsoft. The format is popular for capturing the data of a physical hard drive, including files and folders within disk volume partitions. The typical application includes being used as the hard disk of a virtual machine. <br><br> VHD can host multiple operating systems on a single machine, providing an economical solution for utilizing multiple OSs on one hard drive without additional partitioning. Another key ability of VHD is the management of basic VM features directly from the host server, such as attaching and detaching the disk. <br><br> However, extensive management usually requires full-featured VM software, which can provide: <br><br> - A robust file recovery system <br> - Disk image management <br> - Patching <br> - File transfers between the VHD and the host system <br> - The implementation of security and antivirus applications <br> - A comprehensive system backup <br><br> While Microsoft maintains VHD, it also comes with VirtualBox compatibility. This interconvertibility (occasionally with the use of third-party tools) ensures format portability across virtualization software. Apart from this, it supports dynamically allocated storage, optimizing space utilization.                  | VMDK is a virtual hard disk drive format developed by VMware for its virtual products. It is used by virtual machines such as VMware Workstation and VirtualBox, making it a widely compatible format. <br><br> VMDK stands out for its interconvertibility, allowing portability across virtualization software. Its support for dynamically allocated storage allows the splitting of storage files into less than 2 GB each, helping overcome low file size limits. <br><br> User benchmark tests generally showcase that VMDK outperforms VDI in speed. Additionally, VMDK supports incremental backups, with only data that has been changed since the previous backup being copied. This feature makes backing up data quicker and more efficient than VHD and VDI, which do not support incremental backups. <br><br> Another key feature of VMDK is its ability to clone the physical HDD at the endpoint level, although this requires the right tools and configurations. This feature makes VMDK a robust solution for running multiple operating systems on a single machine. Apart from this, VMDK can also be configured to protect RAID within SAN storage, as its replication provides an off-site VM system. <br><br> It is important to note that while VMDK isn’t designed with physical HDD cloning or RAID protection as its core functionalities, it is still a valuable tool for managing virtual machines and offers advantages in storage management and backups. |



